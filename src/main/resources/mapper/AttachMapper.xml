<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mingyue.mingyue.dao.AttachDao">
    <!--namespace根据自己需要创建的的mapper的路径和名称填写-->


    <select id="get" parameterType="String" resultType="com.mingyue.mingyue.bean.AttachBean">
        select
        <include refid="allFields"/>
        from attach where uuid = #{uuid}
    </select>

    <select id="findByWhere" parameterType="Map" resultType="com.mingyue.mingyue.bean.AttachBean">
        select
        <include refid="allFields"/>
        from attach
        <where>
           <include refid="whereClause"/>
        </where>
        order by id
    </select>


    <select id="findBySubType" parameterType="Map" resultType="com.mingyue.mingyue.bean.AttachBean">
        select
        uuid,`name`,attach_sub_type as attachSubType
        from attach
        <where>
            <include refid="whereClause"/>
        </where>
        order by id asc
    </select>

    <insert id="create"  parameterType="com.mingyue.mingyue.bean.AttachBean" >
        insert into attach  (<include refid="attachInsertFields"/>)
        values (
        #{uuid},
        #{name},
        #{type},
        #{path},
        #{deleteStatus},
        #{status},
        #{createdDate},
        #{createdBy},
        #{updateDate},
        #{updateBy},
        #{attachSubType},
        #{attachType}
        )

    </insert>


    <sql id="allFields">
        uuid,
        `name`,
        `type`,
        `path`,
        delete_status as deleteStatus,
        status,
		created_by as createdBy,
		updated_by as updatedBy,
		updated_date as updatedDate,
		created_date as createdDate,
attach_sub_type as attachSubType,
attach_type as attachType
    </sql>

    <sql id="attachInsertFields">

        uuid,
        `name`,
        `type`,
        `path`,
        delete_status,
        status,
        created_date,
        created_by,
        updated_date,
        updated_by,
attach_sub_type,
attach_type
    </sql>

    <sql id="whereClause">
        <if test="id != null">
            id = #{id}
        </if>
        <if test="type != null">
            and `type` = #{type}
        </if>
        <if test="attachSubType != null">
            and `attach_sub_type` = #{attachSubType}
        </if>
        <if test="attachType != null">
            and `attach_type` = #{attachType}
        </if>
        <choose>
            <when test="deleteStatus != null">
                and delete_status = #{deleteStatus}
            </when>
            <otherwise>
                and delete_status = 0
            </otherwise>
        </choose>
        <choose>
            <when test="status != null">
                and status = #{status}
            </when>
            <otherwise>
                and status = 1
            </otherwise>
        </choose>
        <if test="createdBy != null">
            and created_by = #{createdBy}
        </if>
        <if test="updated_by != null">
            and updated_by = #{updated_by}
        </if>
        <if test="name != null">
            and name like concat(#{name},'%')
        </if>
        <if test="createdDate != null">
            Date(created_date) = Date(#{createdDate})
        </if>
    </sql>

    <insert id="batchCreate" parameterType="list">
        insert into attach  (<include refid="attachInsertFields"/>)
        values
        <foreach collection="list" item="item" index="index" separator=",">
            (

            #{item.uuid},
            #{item.name},
            #{item.type},
            #{item.path},
            #{item.deleteStatus},
            #{item.status},
            #{item.createdDate},
            #{item.createdBy},
            #{item.updateDate},
            #{item.updateBy},
            #{item.attachSubType},
            #{item.attachType}

            )
        </foreach>
    </insert>

</mapper>